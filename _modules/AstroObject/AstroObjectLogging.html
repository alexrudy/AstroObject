
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>AstroObject.AstroObjectLogging &mdash; AstroObject 0.6 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="AstroObject 0.6 documentation" href="../../index.html" />
    <link rel="up" title="AstroObject" href="../AstroObject.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">AstroObject 0.6 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../AstroObject.html" accesskey="U">AstroObject</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for AstroObject.AstroObjectLogging</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># </span>
<span class="c">#  AstroObjectLogging.py</span>
<span class="c">#  AstroObject</span>
<span class="c">#  </span>
<span class="c">#  Created by Alexander Rudy on 2011-12-12.</span>
<span class="c">#  Copyright 2011 Alexander Rudy. All rights reserved.</span>
<span class="c">#  Version 0.6.0</span>
<span class="c">#</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:mod:`AstroObjectLogging` â€” Structured Configuration Logging </span>
<span class="sd">============================================================</span>

<span class="sd">This module provides basic access to logging functions. It elimiates much of the variablity in logging, replacing it with the simple logging configuration options that AstroObject is constantly using. It is, however, built on the normal logging module, and so shouldn&#39;t break any other logging schemes. &lt;http://docs.python.org/library/logging.html&gt;</span>

<span class="sd">Other than a simpler set of possible configuration options, this object has the advantage that it allows for dynamic configurations which vary from run to run. As is common in complex programs, a lot happens before reading a configuration file. However, without the configuration file, the system can&#39;t start logging. This logger holds all the messages it recieves pre-configuration for use once the logger starts, preserving these messages for later debugging.</span>

<span class="sd">To use the logging::</span>
<span class="sd">	</span>
<span class="sd">	LOG = logging.getLogger(__name__)</span>
<span class="sd">	LOG.info(u&quot;Buffered Message Saved for later output&quot;)</span>
<span class="sd">	LOG.configure(configFile=&quot;some.yaml&quot;)</span>
<span class="sd">	LOG.info(u&quot;Buffered Message, saved for later output&quot;)</span>
<span class="sd">	LOG.start()</span>
<span class="sd">	LOG.info(u&quot;Normal Message&quot;)</span>
<span class="sd">	LOG.useConsole(False)</span>
<span class="sd">	LOG.info(u&quot;Not on the console&quot;)</span>
<span class="sd">	LOG.useConsole(True)</span>
<span class="sd">	LOG.info(u&quot;Back to the console!&quot;)</span>
<span class="sd">	</span>

<span class="sd">.. autoclass::</span>
<span class="sd">    AstroObject.AstroObjectLogging.AstroLogger</span>
<span class="sd">    :members:</span>
<span class="sd">    </span>
<span class="sd">.. autoclass::</span>
<span class="sd">    AstroObject.AstroObjectLogging.GrowlHandler</span>
<span class="sd">    :members:</span>
<span class="sd">    </span>
<span class="sd">.. autoclass::</span>
<span class="sd">    AstroObject.AstroObjectLogging.ConsoleFilter</span>
<span class="sd">    :members:</span>
<span class="sd">    </span>
<span class="sd">.. autoclass::</span>
<span class="sd">    AstroObject.AstroObjectLogging.RedirectionHandler</span>
<span class="sd">    :members:</span>
<span class="sd">    </span>
<span class="sd">.. autoclass::</span>
<span class="sd">    AstroObject.AstroObjectLogging.ManyTargetHandler</span>
<span class="sd">    :members:</span>
<span class="sd">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">logging.handlers</span> <span class="kn">as</span> <span class="nn">handlers</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">collections</span>

<span class="kn">from</span> <span class="nn">.AstroConfig</span> <span class="kn">import</span> <span class="n">StructuredConfiguration</span><span class="p">,</span> <span class="n">DottedConfiguration</span>
<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.util</span> <span class="kn">import</span> <span class="n">getVersion</span><span class="p">,</span> <span class="n">ConfigurationError</span><span class="p">,</span> <span class="n">update</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="n">getVersion</span><span class="p">()</span>
<span class="n">__libdebug__</span> <span class="o">=</span> <span class="bp">False</span> <span class="c"># Toggles PRINTED debugger messages for this module, for dev purposes only.</span>


<span class="n">levels</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;LIBDEBUG&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;LIBINFO&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s">&quot;LIBWARN&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">lvl</span> <span class="ow">in</span> <span class="n">levels</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="n">lvl</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">__dbg_print__</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print statements for debugging mode.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">__libdebug__</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">msg</span>
    <span class="k">return</span>

<div class="viewcode-block" id="GrowlHandler"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.GrowlHandler">[docs]</a><span class="k">class</span> <span class="nc">GrowlHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handler that emits growl notifications using the gntp module.</span>
<span class="sd">    </span>
<span class="sd">    Growl notifications are displayed by the growl framework application on desktop computers. They can also be sent over a network to notify a remote host. This logger turns log messages into growl notifications.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GrowlHandler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;AstroObject&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">gntp</span>
            <span class="kn">import</span> <span class="nn">gntp.notifier</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gntp</span> <span class="o">=</span> <span class="n">gntp</span>
        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disable</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disable</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gntp</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">GrowlNotifier</span><span class="p">(</span>
                <span class="n">applicationName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">notifications</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;Info Message&quot;</span><span class="p">,</span><span class="s">&quot;Warning Message&quot;</span><span class="p">,</span><span class="s">&quot;Critical Message&quot;</span><span class="p">,</span><span class="s">&quot;Error Message&quot;</span><span class="p">,</span><span class="s">&quot;Debug Message&quot;</span><span class="p">],</span>
                <span class="n">defaultNotifications</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;Info Message&quot;</span><span class="p">,</span><span class="s">&quot;Warning Message&quot;</span><span class="p">,</span><span class="s">&quot;Critical Message&quot;</span><span class="p">,</span><span class="s">&quot;Error Message&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titles</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Debug&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Info&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Warning&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Critical&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Error&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">}</span>
        
    
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span><span class="s">&quot;Debug Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span><span class="s">&quot;Info Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span><span class="s">&quot;Warning Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span><span class="s">&quot;Critical Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span><span class="s">&quot;Error Message&quot;</span><span class="p">}</span>

    
    
<div class="viewcode-block" id="GrowlHandler.emit"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.GrowlHandler.emit">[docs]</a>    <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">record</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Emits a growl notification&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disable</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span>
                <span class="n">noteType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">levelno</span><span class="p">],</span>
                <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">titles</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">levelno</span><span class="p">],</span>
                <span class="n">description</span> <span class="o">=</span> <span class="n">msg</span><span class="p">,</span>
                <span class="n">sticky</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
                <span class="n">priority</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">SystemExit</span><span class="p">):</span>
            <span class="k">raise</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handleError</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="ConsoleFilter"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.ConsoleFilter">[docs]</a><span class="k">class</span> <span class="nc">ConsoleFilter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Filter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A simple filter to control console-based output.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ConsoleFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="n">on</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="p">[]</span>
        
<div class="viewcode-block" id="ConsoleFilter.filter"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.ConsoleFilter.filter">[docs]</a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">record</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter this record based on whether the console is on.&quot;&quot;&quot;</span>
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;-Filtering Console Active?:</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
</div></div>
<div class="viewcode-block" id="RedirectionHandler"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.RedirectionHandler">[docs]</a><span class="k">class</span> <span class="nc">RedirectionHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;docstring for ManyTargetHandler&quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">targets</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RedirectionHandler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="o">*</span><span class="n">targets</span><span class="p">)</span>

<div class="viewcode-block" id="RedirectionHandler.setTarget"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.RedirectionHandler.setTarget">[docs]</a>    <span class="k">def</span> <span class="nf">setTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add another target to the handler&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">+=</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span>
                </div>
<div class="viewcode-block" id="RedirectionHandler.handle"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.RedirectionHandler.handle">[docs]</a>    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">record</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle this record by redirecting&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,(</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">levelno</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
                        <span class="n">target</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                    <span class="n">tlogger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
                    <span class="n">tlogger</span><span class="o">.</span><span class="n">handler</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="RedirectionHandler.close"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.RedirectionHandler.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the handler&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RedirectionHandler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="p">[]</span>            
</div></div>
<div class="viewcode-block" id="ManyTargetHandler"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.ManyTargetHandler">[docs]</a><span class="k">class</span> <span class="nc">ManyTargetHandler</span><span class="p">(</span><span class="n">handlers</span><span class="o">.</span><span class="n">MemoryHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;docstring for ManyTargetHandler&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">flushLevel</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ManyTargetHandler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">flushLevel</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">+=</span> <span class="n">targets</span>

<div class="viewcode-block" id="ManyTargetHandler.setTarget"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.ManyTargetHandler.setTarget">[docs]</a>    <span class="k">def</span> <span class="nf">setTarget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">target</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add another target to the handler&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">+=</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span>
                </div>
<div class="viewcode-block" id="ManyTargetHandler.flush"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.ManyTargetHandler.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flush out this handler&quot;&quot;&quot;</span>
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;Flushing Buffer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">__dbg_print__</span><span class="p">(</span> <span class="s">&quot;Flushing </span><span class="si">%d</span><span class="s"> to </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">levelno</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
                        <span class="n">__dbg_print__</span><span class="p">(</span> <span class="s">&quot;Flushing to </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">target</span><span class="p">)</span>
                        <span class="n">target</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">__dbg_print__</span><span class="p">(</span> <span class="s">&quot;WARNING: FLUSHING TO NO TARGET&quot;</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="ManyTargetHandler.close"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.ManyTargetHandler.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the handler&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ManyTargetHandler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="p">[]</span>
        </div></div>
<span class="n">_ConsoleFilter</span> <span class="o">=</span> <span class="n">ConsoleFilter</span><span class="p">()</span>

<div class="viewcode-block" id="AstroLogger"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger">[docs]</a><span class="k">class</span> <span class="nc">AstroLogger</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">getLoggerClass</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;A customized logging class. This class is automatically used whenever you are using an AstroObject module elsewhere in your program. It subsumes other logging classes, regardless of the situation. This logger provides many specialized functions useful for logging, but can be used just like a normal logger. By default, the logger starts in buffering mode, collecting messages until it is configured. The configuration then allows it to write messages to the console and to a log file.&quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AstroLogger</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;--Starting </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configured</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handling</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffering</span> <span class="o">=</span> <span class="bp">False</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">dn</span> <span class="o">=</span> <span class="n">DottedConfiguration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filters</span><span class="p">[</span><span class="s">&quot;console&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ConsoleFilter</span>
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;Launched </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="n">handlerClasses</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;growl&#39;</span> <span class="p">:</span> <span class="n">GrowlHandler</span><span class="p">,</span>
        <span class="s">&#39;buffer&#39;</span><span class="p">:</span> <span class="n">ManyTargetHandler</span><span class="p">,</span>
        <span class="s">&#39;null&#39;</span>  <span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">,</span>
        <span class="s">&#39;file&#39;</span>  <span class="p">:</span> <span class="n">handlers</span><span class="o">.</span><span class="n">TimedRotatingFileHandler</span><span class="p">,</span>
        <span class="s">&#39;console&#39;</span> <span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">,</span>
        <span class="s">&#39;simple-file&#39;</span> <span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">_config</span> <span class="o">=</span> <span class="n">StructuredConfiguration</span><span class="p">({</span>
                <span class="s">&#39;logging&#39;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s">&#39;buffer&#39;</span>  <span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;capacity&#39;</span><span class="p">:</span> <span class="mf">1.0e6</span><span class="p">,</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s">&#39;null&#39;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s">&#39;growl&#39;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                        <span class="s">&#39;level&#39;</span>  <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="s">&#39;name&#39;</span> <span class="p">:</span> <span class="s">&quot;AstroObject&quot;</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s">&#39;file&#39;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                        <span class="s">&#39;format&#39;</span> <span class="p">:</span> <span class="s">&quot;</span><span class="si">%(asctime)s</span><span class="s"> : </span><span class="si">%(levelname)-8s</span><span class="s"> : </span><span class="si">%(module)-15s</span><span class="s"> : </span><span class="si">%(funcName)-10s</span><span class="s"> : </span><span class="si">%(message)s</span><span class="s">&quot;</span><span class="p">,</span>
                        <span class="s">&#39;dateformat&#39;</span> <span class="p">:</span> <span class="s">&quot;%H:%M:%S&quot;</span><span class="p">,</span>
                        <span class="s">&#39;filename&#39;</span> <span class="p">:</span> <span class="n">__name__</span><span class="p">,</span>
                        <span class="s">&#39;level&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="s">&#39;when&#39;</span>  <span class="p">:</span> <span class="s">&#39;midnight&#39;</span>
                    <span class="p">},</span>
                    <span class="s">&#39;console&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                        <span class="s">&#39;format&#39;</span> <span class="p">:</span> <span class="s">&quot;...</span><span class="si">%(message)s</span><span class="s">&quot;</span><span class="p">,</span>
                        <span class="s">&#39;level&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">},</span>
                <span class="p">},</span>
                    <span class="s">&#39;Dirs&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;Logs&#39;</span> <span class="p">:</span> <span class="s">&quot;Logs&quot;</span>
                    <span class="p">},</span>
            <span class="p">})</span>
    
    <span class="nd">@property</span>
<div class="viewcode-block" id="AstroLogger.config"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A read only element that is the configuration for this system.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StructuredConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">store</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="AstroLogger.configure_from_file"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.configure_from_file">[docs]</a>    <span class="k">def</span> <span class="nf">configure_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;docstring for configure_from_file&quot;&quot;&quot;</span>
        <span class="n">__dbg_print__</span><span class="p">(</span> <span class="s">&quot;--Configure </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">configured</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                    
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">configured</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s">&quot;No configuration provided or accessed. Using defaults.&quot;</span><span class="p">)</span>
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;--END Configure </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="AstroLogger.configure"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">configuration</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure this logging object using a configuration dictionary. Configuration dictionaries can be provided by a YAML file or directly to the configuration argument. If both are provided, the YAML file will over-ride the explicit dictionary.&quot;&quot;&quot;</span>
        
        <span class="n">__dbg_print__</span><span class="p">(</span> <span class="s">&quot;--Configure </span><span class="si">%s</span><span class="s"> &quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="c"># Configure from Variable</span>
        <span class="k">if</span> <span class="n">configuration</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Updated Configuration from variable&quot;</span><span class="p">)</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">configured</span> <span class="o">|=</span> <span class="bp">True</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">configured</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s">&quot;No configuration provided or accessed. Using defaults.&quot;</span><span class="p">)</span>
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;--END Configure </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="AstroLogger.start"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts this logger running, using the configuration set using :meth:`configure`. The configuration can configure a file handler and a console handler. Arbitrary configurations are not possible at this point.&quot;&quot;&quot;</span>
        <span class="n">__dbg_print__</span><span class="p">(</span> <span class="s">&quot;--Starting Handlers in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_handlers</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffering</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">&#39;buffer&#39;</span><span class="p">:</span>
                    <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;-Buffer Targeting </span><span class="si">%s</span><span class="s"> in </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="s">&#39;buffer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setTarget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s">&quot;logging.buffer.enable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_handler</span><span class="p">(</span><span class="s">&#39;buffer&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffering</span> <span class="o">=</span> <span class="bp">False</span>       
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;--- LOG LEVEL </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getEffectiveLevel</span><span class="p">()))</span>
    </div>
<div class="viewcode-block" id="AstroLogger.setup_handlers"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.setup_handlers">[docs]</a>    <span class="k">def</span> <span class="nf">setup_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">handlers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets up the handlers based on the configuration&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">handlers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">handlers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">handlers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
            
            </div>
<div class="viewcode-block" id="AstroLogger.setup_handler"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.setup_handler">[docs]</a>    <span class="k">def</span> <span class="nf">setup_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">handler</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;docstring for setup_handler&quot;&quot;&quot;</span>
        <span class="c"># Extract Handler setup information</span>
        <span class="n">hconfig</span> <span class="o">=</span> <span class="n">DottedConfiguration</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="n">handler</span><span class="p">]</span><span class="o">.</span><span class="n">store</span><span class="p">))</span>
        <span class="c"># Set up configuration variables</span>
        <span class="n">enable</span> <span class="o">=</span> <span class="n">hconfig</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;enable&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">hconfig</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;level&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">format</span> <span class="o">=</span> <span class="n">hconfig</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;format&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">dateformat</span> <span class="o">=</span> <span class="n">hconfig</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;dateformat&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&quot;filename&quot;</span> <span class="ow">in</span> <span class="n">hconfig</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s">&quot;Dirs.Logs&quot;</span><span class="p">]):</span>
                <span class="n">enable</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">hconfig</span><span class="p">[</span><span class="s">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%(Logs)s</span><span class="s">/</span><span class="si">%(filename)s</span><span class="s">.log&quot;</span> <span class="o">%</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">hconfig</span><span class="p">[</span><span class="s">&quot;filename&quot;</span><span class="p">],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s">&quot;Dirs&quot;</span><span class="p">])</span>
        
        <span class="c"># Short Circuit for options not taken.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">enable</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">handler</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span>
                <span class="n">hobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">handler</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="n">hobject</span><span class="p">)</span>
                <span class="n">hobject</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">handler</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;Deactivating Handler </span><span class="si">%s</span><span class="s">: Deleted.&quot;</span> <span class="o">%</span> <span class="n">handler</span><span class="p">)</span>
                <span class="c"># Flag that we aren&#39;t handling, if there are no handlers left.</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">handling</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;Deactivating Handler </span><span class="si">%s</span><span class="s">: Does not exist.&quot;</span> <span class="o">%</span> <span class="n">handler</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">elif</span> <span class="n">handler</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;Activating Handler </span><span class="si">%s</span><span class="s">: Already active.&quot;</span> <span class="o">%</span> <span class="n">handler</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Create the handler object from the configuration</span>
            <span class="k">if</span> <span class="n">handler</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlerClasses</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">handler</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlerClasses</span><span class="p">[</span><span class="n">handler</span><span class="p">](</span><span class="o">**</span><span class="n">hconfig</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">handler</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span><span class="n">handler</span><span class="p">)(</span><span class="o">**</span><span class="n">hconfig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;Activating Handler </span><span class="si">%s</span><span class="s">: Handler created&quot;</span> <span class="o">%</span> <span class="n">handler</span><span class="p">)</span>
        
        <span class="n">hobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">handler</span><span class="p">]</span>
        <span class="c"># Set the level of the handler object</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">hobject</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hobject</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;Setting Handler </span><span class="si">%s</span><span class="s"> Level: </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">handler</span><span class="p">,</span><span class="n">hobject</span><span class="o">.</span><span class="n">level</span><span class="p">))</span>    
        
        <span class="c"># Format the handler object</span>
        <span class="k">if</span> <span class="n">format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="n">format</span><span class="p">,</span><span class="n">datefmt</span><span class="o">=</span><span class="n">dateformat</span><span class="p">)</span>
            <span class="n">hobject</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;Applying Handler </span><span class="si">%s</span><span class="s"> Formatter&quot;</span> <span class="o">%</span> <span class="n">handler</span><span class="p">)</span>
            
        <span class="c"># Apply a console filter if this handler passes to streams</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hobject</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">)</span> <span class="ow">and</span> <span class="n">hobject</span><span class="o">.</span><span class="n">stream</span> <span class="o">==</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">:</span>
            <span class="n">hobject</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filters</span><span class="p">[</span><span class="s">&quot;console&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;Applying Handler </span><span class="si">%s</span><span class="s"> Console Filter&quot;</span> <span class="o">%</span> <span class="n">handler</span><span class="p">)</span>
            
        <span class="c"># Enable and Activate the Handler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handlers</span><span class="p">[</span><span class="n">handler</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handling</span> <span class="o">=</span> <span class="bp">True</span>
            </div>
<div class="viewcode-block" id="AstroLogger.useConsole"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.useConsole">[docs]</a>    <span class="k">def</span> <span class="nf">useConsole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">use</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Turn on or off the console logging. Specify the parameter `use` to force console logging into one state or the other. If the `use` parameter is not given, console logging will be toggled.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">use</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filters</span><span class="p">[</span><span class="s">&quot;console&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filters</span><span class="p">[</span><span class="s">&quot;console&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">on</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filters</span><span class="p">[</span><span class="s">&quot;console&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="n">use</span>
        <span class="n">__dbg_print__</span><span class="p">(</span><span class="s">&quot;Console is now: </span><span class="si">%s</span><span class="s"> for </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filters</span><span class="p">[</span><span class="s">&quot;console&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">on</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        </div>
<div class="viewcode-block" id="AstroLogger.init_buffer"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.AstroLogger.init_buffer">[docs]</a>    <span class="k">def</span> <span class="nf">init_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets up an initialization buffer&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">[</span><span class="s">&quot;logging.buffer.enable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_handlers</span><span class="p">(</span><span class="s">&#39;buffer&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffering</span> <span class="o">=</span> <span class="bp">True</span>
</div></div>
<span class="n">logging</span><span class="o">.</span><span class="n">setLoggerClass</span><span class="p">(</span><span class="n">AstroLogger</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">captureWarnings</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&#39;py.warnings&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">RedirectionHandler</span><span class="p">(</span><span class="n">__name__</span><span class="p">))</span>


<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">AstroObject 0.6 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../AstroObject.html" >AstroObject</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Alexander Rudy.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>