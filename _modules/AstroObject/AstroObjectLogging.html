

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>AstroObject.AstroObjectLogging &mdash; AstroObject 0.3.6-p1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.3.6-p1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="AstroObject 0.3.6-p1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">AstroObject 0.3.6-p1 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for AstroObject.AstroObjectLogging</h1><div class="highlight"><pre>
<span class="c"># </span>
<span class="c">#  AstroObjectLogging.py</span>
<span class="c">#  AstroObject</span>
<span class="c">#  </span>
<span class="c">#  Created by Alexander Rudy on 2011-12-12.</span>
<span class="c">#  Copyright 2011 Alexander Rudy. All rights reserved.</span>
<span class="c">#  Version 0.3.6-p1</span>
<span class="c">#</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">logging.handlers</span> <span class="kn">as</span> <span class="nn">handlers</span>

<span class="kn">import</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">yaml</span>

<span class="kn">from</span> <span class="nn">Utilities</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="n">getVersion</span><span class="p">()</span>

<span class="n">logging</span><span class="o">.</span><span class="n">captureWarnings</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="n">levels</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;LIBDEBUG&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;LIBINFO&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s">&quot;LIBWARN&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">lvl</span> <span class="ow">in</span> <span class="n">levels</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="n">lvl</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">GrowlHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handler that emits growl notifications&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GrowlHandler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;AstroObject&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">gntp.notifier</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gntp</span> <span class="o">=</span> <span class="n">gntp</span>
        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disable</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disable</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gntp</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">GrowlNotifier</span><span class="p">(</span>
                <span class="n">applicationName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">notifications</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;Info Message&quot;</span><span class="p">,</span><span class="s">&quot;Warning Message&quot;</span><span class="p">,</span><span class="s">&quot;Critical Message&quot;</span><span class="p">,</span><span class="s">&quot;Error Message&quot;</span><span class="p">,</span><span class="s">&quot;Debug Message&quot;</span><span class="p">],</span>
                <span class="n">defaultNotifications</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;Info Message&quot;</span><span class="p">,</span><span class="s">&quot;Warning Message&quot;</span><span class="p">,</span><span class="s">&quot;Critical Message&quot;</span><span class="p">,</span><span class="s">&quot;Error Message&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">titles</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Debug&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Info&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Warning&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Critical&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> Error&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
        
    
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span><span class="s">&quot;Debug Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">:</span><span class="s">&quot;Info Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">:</span><span class="s">&quot;Warning Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span><span class="s">&quot;Critical Message&quot;</span><span class="p">,</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span><span class="s">&quot;Error Message&quot;</span><span class="p">}</span>

    
    
    <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">record</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Emits a growl notification&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disable</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span>
                <span class="n">noteType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapping</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">levelno</span><span class="p">],</span>
                <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">titles</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">levelno</span><span class="p">],</span>
                <span class="n">description</span> <span class="o">=</span> <span class="n">msg</span><span class="p">,</span>
                <span class="n">sticky</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
                <span class="n">priority</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">SystemExit</span><span class="p">):</span>
            <span class="k">raise</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handleError</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

        

<div class="viewcode-block" id="LogManager"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.LogManager">[docs]</a><span class="k">class</span> <span class="nc">LogManager</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">getLoggerClass</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;A customized logging class. This class is automatically used whenever you are using an AstroObject module elsewhere in your program. It subsumes other logging classes, regardless of the situation. This logger provides many specialized functions useful for logging, but can be used just like a normal logger. By default, the logger starts in buffering mode, collecting messages until it is configured. The configuration then allows it to write messages to the console and to a log file.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LogManager</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configured</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handling</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doConsole</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes this logger to buffer messages it receives before it is configured. This initialization is automatically handled when the :class:`LogManager` is created.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handling</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s">&quot;Logger appears to be already handling messages&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s">&quot;Logger seems to already have started&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">configured</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s">&quot;Logger appears to be already configured&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">MemoryHandler</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">null</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&#39;logging&#39;</span> <span class="p">:</span> <span class="p">{</span>
                    <span class="s">&#39;growl&#39;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                        <span class="s">&#39;level&#39;</span>  <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                        <span class="s">&#39;name&#39;</span> <span class="p">:</span> <span class="s">&quot;AstroObject&quot;</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s">&#39;file&#39;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                        <span class="s">&#39;format&#39;</span> <span class="p">:</span> <span class="s">&quot;</span><span class="si">%(asctime)s</span><span class="s"> : </span><span class="si">%(levelname)-8s</span><span class="s"> : </span><span class="si">%(module)-15s</span><span class="s"> : </span><span class="si">%(funcName)-10s</span><span class="s"> : </span><span class="si">%(message)s</span><span class="s">&quot;</span><span class="p">,</span>
                        <span class="s">&#39;dateformat&#39;</span> <span class="p">:</span> <span class="s">&quot;%H:%M:%S&quot;</span><span class="p">,</span>
                        <span class="s">&#39;filename&#39;</span> <span class="p">:</span> <span class="s">&quot;AstroObject&quot;</span><span class="p">,</span>
                        <span class="s">&#39;level&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s">&#39;console&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;enable&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                        <span class="s">&#39;format&#39;</span> <span class="p">:</span> <span class="s">&quot;...</span><span class="si">%(message)s</span><span class="s">&quot;</span><span class="p">,</span>
                        <span class="s">&#39;level&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">},</span>
                <span class="p">},</span>
                    <span class="s">&#39;Dirs&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&#39;Logs&#39;</span> <span class="p">:</span> <span class="s">&quot;Logs/&quot;</span>
                    <span class="p">},</span>
            <span class="p">}</span>
    
<div class="viewcode-block" id="LogManager.configure"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.LogManager.configure">[docs]</a>    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">configFile</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">configuration</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure this logging object using a configuration dictionary. Configuration dictionaries can be provided by a YAML file or directly to the configuration argument. If both are provided, the YAML file will over-ride the explicit dictionary.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handling</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s">&quot;Logger appears to be already handling&quot;</span><span class="p">)</span>
        <span class="c"># Configure from Variable</span>
        <span class="k">if</span> <span class="n">configuration</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span><span class="n">configuration</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Updated Configuration from variable&quot;</span><span class="p">)</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">configured</span> <span class="o">|=</span> <span class="bp">True</span>
        <span class="c"># Configure from File</span>
        <span class="k">if</span> <span class="n">configFile</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">configFile</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
                    <span class="n">loaded</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span><span class="n">loaded</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Couldn&#39;t load Configuration File </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">configFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">configured</span> <span class="o">|=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">configured</span> <span class="o">|=</span> <span class="bp">True</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">configured</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s">&quot;No configuration provided or accessed. Using defaults.&quot;</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="LogManager.start"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.LogManager.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts this logger running, using the configuration set using :meth:`configure`. The configuration can configure a file handler and a console handler. Arbitrary configurations are not possible at this point.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">handling</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s">&quot;Logger appears to be already handling messages&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s">&quot;Logger appears to not be running. This should never happen&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">configured</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s">&quot;Logger appears not to be configured&quot;</span><span class="p">)</span>
        
        <span class="c"># Setup the Console Log Handler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>    
        <span class="n">consoleFormatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;console&quot;</span><span class="p">][</span><span class="s">&quot;format&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">consoleFormatter</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;console&quot;</span><span class="p">][</span><span class="s">&quot;level&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;console&quot;</span><span class="p">][</span><span class="s">&quot;level&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;console&quot;</span><span class="p">][</span><span class="s">&quot;enable&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">doConsole</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handling</span> <span class="o">|=</span> <span class="bp">True</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logfolder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;Dirs&quot;</span><span class="p">][</span><span class="s">&quot;Logs&quot;</span><span class="p">]</span><span class="o">+</span><span class="s">&quot;/&quot;</span>
        
        <span class="c"># Only set up the file log handler if we can actually access the folder</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logfolder</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">F_OK</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%(dir)s</span><span class="s">/</span><span class="si">%(name)s</span><span class="s">.log&quot;</span> <span class="o">%</span> <span class="p">{</span><span class="s">&#39;dir&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;Dirs&quot;</span><span class="p">][</span><span class="s">&quot;Logs&quot;</span><span class="p">],</span><span class="s">&#39;name&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;filename&quot;</span><span class="p">]}</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">TimedRotatingFileHandler</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">when</span><span class="o">=</span><span class="s">&#39;midnight&#39;</span><span class="p">)</span>
            <span class="n">fileformatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;format&quot;</span><span class="p">],</span><span class="n">datefmt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;dateformat&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">fileformatter</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;level&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;level&quot;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">)</span>
                        
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;enable&quot;</span><span class="p">]:</span>
            
                <span class="bp">self</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">)</span>
                <span class="c"># Finally, we should flush the old buffers</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">setTarget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handling</span> <span class="o">|=</span> <span class="bp">True</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;growl&quot;</span><span class="p">][</span><span class="s">&quot;enable&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">growlHandler</span> <span class="o">=</span> <span class="n">GrowlHandler</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;growl&quot;</span><span class="p">][</span><span class="s">&quot;name&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">growlHandler</span><span class="o">.</span><span class="n">disable</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;growl&quot;</span><span class="p">][</span><span class="s">&quot;enable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;level&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">growlHandler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;file&quot;</span><span class="p">][</span><span class="s">&quot;level&quot;</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">growlHandler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">growlHandler</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handling</span> <span class="o">|=</span> <span class="bp">True</span>
                
        
        <span class="bp">self</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">handling</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">null</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s">&quot;Logger not actually handling anything!&quot;</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="LogManager.useConsole"><a class="viewcode-back" href="../../AstroObjectLogging.html#AstroObject.AstroObjectLogging.LogManager.useConsole">[docs]</a>    <span class="k">def</span> <span class="nf">useConsole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">use</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Turn on or off the console logging. Specify the parameter `use` to force console logging into one state or the other. If the `use` parameter is not given, console logging will be toggled.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">use</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># THIS SHOULD BE BACKWARDS</span>
            <span class="c"># If we turn the console on now, then this very function will turn it off in a minute!</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doConsole</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">use</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">handling</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s">&quot;Logger appears to not already be handling messages&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationError</span><span class="p">(</span><span class="s">&quot;Logger appears to not be running. This should never happen&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s">&quot;logging&quot;</span><span class="p">][</span><span class="s">&quot;console&quot;</span><span class="p">][</span><span class="s">&quot;enable&quot;</span><span class="p">]:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doConsole</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">removeHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doConsole</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">console</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doConsole</span> <span class="o">=</span> <span class="bp">True</span>
</div></div>
<span class="n">logging</span><span class="o">.</span><span class="n">setLoggerClass</span><span class="p">(</span><span class="n">LogManager</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">AstroObject 0.3.6-p1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Alexander Rudy.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>